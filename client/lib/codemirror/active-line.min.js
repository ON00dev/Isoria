!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t={},i=/^$/;function n(e,t){var i=e.getWrapperElement();e.state.activeLines=[];for(var n=t.head.line,l=t.anchor.line;n<=l;n++){var a=document.createElement("div");a.className="CodeMirror-activeline-background CodeMirror-linebackground",e.state.activeLines.push(a),i.querySelector(".CodeMirror-lines").querySelector(".CodeMirror-code").childNodes[n-e.firstLine()].appendChild(a)}}function l(e){(e.state.activeLines||[]).forEach(function(e){e.parentNode.removeChild(e)}),e.state.activeLines=null}function a(e,i){if(!e.getOption("disableInput")){var n=e.state.activeLines;if(n)for(var a=0;a<n.length;a++)n[a].className="CodeMirror-activeline-background CodeMirror-linebackground";var r=e.getOption("styleActiveLine");if("object"==typeof r&&r.nonEmpty?i.anchor.line!=i.head.line:r&&i.head.line!=i.anchor.line)return l(e);if(r&&!t[e.id]){var o=i.head.line;(e.doc.sel.ranges.length>1||e.doc.sel.ranges[0].head.line==e.doc.sel.ranges[0].anchor.line)&&(o=-1);var c=e.getLineHandle(o),s=e.getOption("styleActiveLineGutter");if(null!=c&&(0!=o||s)){var d=e.getLineNumber(c);if(null!=d){var f=e.display.view;if(!(d<e.display.viewFrom||d>=e.display.viewTo)){var u=e.display.externalMeasured;u&&d>=u.lineN&&d<u.lineN+u.size&&(f=e.display.externalMeasured.node);var v=f.querySelector(".CodeMirror-line");if(v){var p=document.createElement("div");p.className="CodeMirror-activeline-background CodeMirror-linebackground";var h=v.getBoundingClientRect();if(e.display.lineNumChars>0&&s){var m=e.display.lineDiv.querySelector(".CodeMirror-gutter-wrapper");if(m){var g=m.querySelector(".CodeMirror-linenumber");if(g){var C=g.getBoundingClientRect();p.style.left=C.left-h.left+"px",p.style.width=C.width+"px"}}}e.state.activeLines=[p],v.appendChild(p)}}}}}}}e.defineOption("styleActiveLine",!1,function(n,r,o){var c=o!=e.Init&&o;r!=c&&(c&&(n.off("beforeSelectionChange",a),l(n),delete n.state.activeLines),r&&(n.state.activeLines=[],n.on("beforeSelectionChange",a),t[n.id]=!0,a(n,n.doc.sel.ranges[0])))}),e.defineOption("styleActiveLineGutter",!1,function(t,i,n){var l=n!=e.Init&&n;i!=l&&t.state.activeLines&&t.operation(function(){a(t,t.doc.sel.ranges[0])})}),e.defineExtension("addLineClass",function(e,t,l){return n(this,{head:{line:e,ch:0},anchor:{line:e,ch:0}}),i.test(l)?this:this}),e.defineExtension("removeLineClass",function(e,t,n){return l(this),i.test(n)?this:this})});